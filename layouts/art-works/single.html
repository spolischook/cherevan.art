{{ define "main" }}
<article class="flex flex-col">
    <section class="flex flex-col sm:flex-row sm:space-x-8">
        <div class="sm:w-1/2">
            {{ $image := .Resources.GetMatch .Params.mainImage }}
            {{ if $image }}
                {{ partial "art-works/picture.html" (dict "image" $image "title" .Title "inStock" .Params.inStock "index" 0) }}
            {{ else }}
                <div class=""></div>
            {{ end }}
        </div>

        <div class="sm:w-1/2">
            <h1 class="text-4xl font-bold pb-2 text-tiger-300">{{ .Title }}</h1>
            <div class="text-2xl font-bold">â‚¬&nbsp{{ lang.FormatNumberCustom 2 .Params.Price }}</div>
            <div class="text-gray-500 text-sm pb-6">Local taxes included (where applicable)</div>
            <div class="pb-2 text-xl"><span class="font-bold">Size: </span>{{ .Params.width }}&nbspX&nbsp{{ .Params.height }}&nbspcm</div>
            <div class="text-xl font-bold">Materials:</div>
            <ul class="text-xl pb-2">
                {{ range .Params.materials }}
                    <li>- {{ . }}</li>
                {{ end }}
            </ul>
            <ul class="pt-5 text-blackish">
                <li>
                    <svg class="w-5 h-5 float-left mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                        <path d="M9.057 20.47l-6.764-6.763a1 1 0 011.414-1.414l5.236 5.236 11.3-13.18a1.001 1.001 0 111.518 1.3L9.057 20.47z"></path>
                    </svg>
                    Arrives soon! Get it by <span class="underline" title="If you order today, this is the estimated delivery date and is based on the seller's processing time and location, carrier transit time, and your shipping address. Keep in mind: shipping carrier delays or placing an order on a weekend or holiday may push this date.">{{ now.AddDate 0 0 10 | dateFormat "Jan 02" }} - {{ now.AddDate 0 0 14 | dateFormat "Jan 02" }}</span> if you order today
                </li>
                <li>
                    <svg class="w-5 h-5 float-left mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                        <path d="M9.057 20.47l-6.764-6.763a1 1 0 011.414-1.414l5.236 5.236 11.3-13.18a1.001 1.001 0 111.518 1.3L9.057 20.47z"></path>
                    </svg>
                    Returns accepted
                </li>
            </ul>
            <button id="buy-button" class="mt-6 w-full bg-tiger-300 text-white py-2 px-4 rounded-full text-lg font-bold">Buy now</button>
        </div>
    </section>

    <div class="flex flex-col sm:flex-row items-start sm:items-center sm:justify-between mb-5">
        <ul class="m-0 mt-1 pl-0 flex space-x-2 list-none">
            {{ range .Params.tags }}
            <li>
                <a class="link flex space-x-1 justify-center items-center"
                    href="{{ $.Site.BaseURL }}tags/{{ . | urlize }}">
                    <svg class="octicon octicon-tag" viewBox="0 0 14 16" version="1.1" width="14" height="16"
                        aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1 3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 0 0 0-1.41L7.73 1.73zM2.38 7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59 1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73 4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z">
                        </path>
                    </svg>
                    <span>{{ . }}</span></a>
            </li>
            {{ end }}
        </ul>
    </div>
    {{.Content}}
</article>
{{ end }}
{{ define "scripts" }}
    <script src="https://sdks.shopifycdn.com/js-buy-sdk/v2/latest/index.umd.min.js"></script>
    <script>
        const client = ShopifyBuy.buildClient({
            domain: '{{ .Site.Params.shopifyDomain }}',
            storefrontAccessToken: {{ .Site.Params.storefrontAccessToken }}
        });

        document.getElementById('buy-button').addEventListener('click', function() {
            client.checkout.create().then((checkout) => {
                const lineItemsToAdd = [
                    {
                        variantId: '{{ (printf "gid://shopify/ProductVariant/%d" .Params.shopifyOptionId) | base64Encode }}',
                        quantity: 1,
                    },
                ];

                client.checkout.addLineItems(checkout.id, lineItemsToAdd);
                console.log(checkout);
                return checkout
            }).then((checkout) => {
                // window.location.href = checkout.webUrl;
                console.log(checkout);
            });
        });

    </script>
{{ end }}
